{{ $img := .Page.Resources.GetMatch (printf "*%s*" (.Get "src")) }}

{{ if eq $img nil }}
  {{ errorf "Failed to find image %s" (.Get "src") }}
{{ end }}

<figure id={{.Get "id"}}>
  {{ partial "image" (dict "ctx" . "img" $img "caption" (.Get "caption")) }}
  <figcaption>{{ (.Get "caption") | markdownify }}</figcaption>
</figure>
